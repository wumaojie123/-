(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2ed5"],{ACzA:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return s});var a=n("t3Un");function i(){return Object(a.a)({url:"/equipment/getEquipmentTypes",method:"get"})}function s(){return Object(a.a)({url:"/rest/equipment/equipmentType/querySHL",method:"get"})}},"Dz/4":function(e,t,n){"use strict";n.r(t);var a=n("ACzA"),i=n("jzU3"),s={name:"DevicesImport",data:function(){return{fileList:[],file:null,agentnick:"",infoChecked:!1,form:{equipmentTypes:"",agent:""},equipmentTypesArr:[],agentUsers:[],message:"请将设备注册编号放入txt文档，每一行代表一个设备编号，如果编号未被绑定注册或待调拨，导入将成功，反之，则将失败。注意：Excel的数据可以直接复制到txt文档中。"}},computed:{disabled:function(){return!this.form.equipmentTypes||!this.form.agent},uploadPar:function(){return{agentUserId:this.form.agent,equipmentType:this.form.equipmentTypes}}},created:function(){var e=this;Object(a.b)().then(function(t){0===t.result&&t.data&&t.data.length&&t.data.forEach(function(t){e.equipmentTypesArr.push({value:t.code,label:t.name})})})},methods:{submitUpload:function(){this.file?this.form.agent&&!this.infoChecked?this.$refs.upload.submit():this.$message.error("请选择代理商！"):this.$message.error("请选择上传文件！")},removeFile:function(){this.file=null},onChange:function(e){this.file=e},handleSelect:function(e){this.form.agent=e.agentId},querySearch:function(e,t){var n=this,a=/^(.+)\((.+)\)$/.exec(e);a&&(e=a[1]&&a[1].trim()),Object(i.a)({agentQuery:e}).then(function(e){if(0===e.result&&e.data&&0!==e.data.length){var a=[];e.data.forEach(function(e){a.push({value:e.agentusername+" ("+e.phone+")",agentId:e.agentuserid})}),n.agentUsers=a,n.infoChecked=!1,t(a)}else n.infoChecked=!0,t([])}),this.form.agent=""},handleSuccess:function(e){if(0===e.result){var t=0===e.data.fail.length?"":"失败"+e.data.fail.length+"条;\n        失败的设备编号："+e.data.fail.join(",");this.$alert(e.description+" "+t,"导入结果",{confirmButtonText:"确定"})}},handleExceed:function(){this.$message.warning("当前限制选择 1 个文件，一次只能上传一个文件")},handleError:function(){this.$message.error("导入失败！")}}},l=(n("SmMr"),n("KHd+")),r=Object(l.a)(s,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-main",[n("el-alert",{staticClass:"info",attrs:{title:e.message,closable:!1,type:"warning"}}),e._v(" "),n("el-form",{ref:"form",staticClass:"deviceForm",staticStyle:{padding:"16px 0",width:"400px"},attrs:{model:e.form,"label-width":"90px"}},[n("el-row",[n("el-col",[n("el-form-item",{attrs:{label:"设备类型",prop:"equipmentTypes"}},[n("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.equipmentTypes,callback:function(t){e.$set(e.form,"equipmentTypes",t)},expression:"form.equipmentTypes"}},e._l(e.equipmentTypesArr,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1)],1),e._v(" "),n("el-row",[n("el-col",[n("el-form-item",{attrs:{label:"代理商",prop:"agent"}},[n("el-autocomplete",{staticClass:"width200",attrs:{"fetch-suggestions":e.querySearch,"popper-class":"my-autocomplete",placeholder:"请输入内容"},on:{select:e.handleSelect},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.item;return[n("div",{staticClass:"name"},[e._v(e._s(a.value))])]}}]),model:{value:e.agentnick,callback:function(t){e.agentnick=t},expression:"agentnick"}}),e._v(" "),n("p",{directives:[{name:"show",rawName:"v-show",value:e.infoChecked,expression:"infoChecked"}],staticStyle:{"font-size":"14px",color:"red"}},[e._v("未查询到相应的商家，请重新输入！")])],1)],1)],1),e._v(" "),n("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{"on-success":e.handleSuccess,"on-error":e.handleError,"file-list":e.fileList,"on-change":e.onChange,"on-remove":e.removeFile,"auto-upload":!1,data:e.uploadPar,disabled:e.disabled,"on-exceed":e.handleExceed,limit:1,accept:".txt",action:"/agent/rest/file/batch/import"}},[n("el-row",{attrs:{slot:"trigger"},slot:"trigger"},[n("el-col",[n("el-button",{attrs:{disabled:e.disabled,size:"small",type:"primary"}},[e._v("选择txt文件")])],1),e._v(" "),n("el-col",[n("ul",{staticClass:"el-upload-list el-upload-list--text"})])],1),e._v(" "),n("div",{staticStyle:{padding:"8px"}}),e._v(" "),n("el-button",{attrs:{disabled:e.disabled,size:"small",type:"success"},on:{click:e.submitUpload}},[e._v("确定上传")])],1)],1)],1)},[],!1,null,null,null);r.options.__file="deviceImport.vue";t.default=r.exports},SmMr:function(e,t,n){"use strict";var a=n("vaBS");n.n(a).a},jzU3:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n("t3Un");function i(e){return Object(a.a)({url:"/rest/equipment/childAgents/query",method:"get",params:e})}},vaBS:function(e,t,n){}}]);