(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-b3d7","chunk-0e1c"],{"0Bl4":function(e,t,i){"use strict";var r=i("xXYc");i.n(r).a},bSnj:function(e,t,i){"use strict";i.d(t,"a",function(){return n}),i.d(t,"b",function(){return o}),i.d(t,"c",function(){return l});var r=i("t3Un");function n(e){return Object(r.a)({url:"/rest/factory/agentGroupServiceList",method:"get",params:e})}function o(e){return Object(r.a)({url:"/rest/factory/savaGroupService",method:"post",data:e})}function l(e){return Object(r.a)({url:"/rest/factory/updateGroupService",method:"post",data:e})}},d2aE:function(e,t,i){"use strict";var r=i("o7LA");i.n(r).a},iR9m:function(e,t,i){"use strict";i.r(t);var r=i("XJYT"),n=i("bSnj"),o=i("Yfch"),l=function(e,t,i){Object(o.c)(t)&&t<1e4&&t>0?i():i(new Error("价格必须为大于0的正数,价格需小于10000,最多保留2位小数"))},a=function(e,t,i){Object(o.b)(t)&&t<=9999&&t>0?i():i(new Error("模拟投币数必须为大于0小于等于9999的正整数"))},c={props:{handleClose:{type:Function,default:function(){}},queryList:{type:Function,default:function(){}},visible:{type:Boolean,default:!1},actionRow:{type:Object,default:null},actionType:{type:String,default:""}},data:function(){return{ruleForm:{equipmentType:"CDZ",communication:1,billing:1,description:"",price:"",coins:"",serviceTime:"",electric:""},rules:{equipmentType:[{required:!0,message:"请选择设备类型",trigger:"blur"}],communication:[{required:!0,message:"请选择通信方式",trigger:"blur"}],billing:[{required:!0,message:"请选择计费方式",trigger:"blur"}],description:[{required:!0,message:"请输入套餐名称",trigger:"change"},{max:12,message:"套餐名称长度不能超过12",trigger:"change"}],price:[{required:!0,message:"请输入价格",trigger:"change"},{validator:l}],coins:[{required:!0,message:"请输入模拟投币数",trigger:"change"},{validator:a}],serviceTime:[],electric:[]},loading_submit:!1,arrBilling:[{value:1,label:"按时长计费"},{value:2,label:"按电量计费"}]}},computed:{getTitle:function(){return"add"===this.actionType?"添加服务套餐":"编辑服务套餐"}},created:function(){},methods:{onClose:function(){this.$refs.ruleForm.resetFields(),this.ruleForm.coins="",this.ruleForm.serviceTime="",this.ruleForm.electric="",this.handleClose()},onOpen:function(){"edit"===this.actionType&&this.actionRow&&(this.ruleForm={equipmentType:this.actionRow.equipmentType,communication:this.actionRow.communication,billing:this.actionRow.billing,description:this.actionRow.description,price:this.actionRow.price,coins:null===this.actionRow.coins?"":this.actionRow.coins},2===this.actionRow.billing?this.ruleForm.electric=this.actionRow.electric:this.ruleForm.serviceTime=null===this.actionRow.serviceTime?"":this.actionRow.serviceTime)},onSubmit:function(){var e=this;if(2===e.ruleForm.billing){if(""===this.ruleForm.electric)return void Object(r.Message)({type:"warning",message:"请输入电量"});if(!(/^-?\d+\.?\d{0,1}$/.test(this.ruleForm.electric)&&this.ruleForm.electric<50&&this.ruleForm.electric>0))return void Object(r.Message)({message:"电量必须为大于0的正数，电量需小于50，最多一位小数",type:"warning"})}else{if(""===this.ruleForm.serviceTime)return void Object(r.Message)({message:"请输入时长",type:"warning"});if(!(Object(o.b)(e.ruleForm.serviceTime)&&e.ruleForm.serviceTime<=1440))return void Object(r.Message)({message:"服务时间必须为大于0的小于等于1440(24小时)正整数",type:"warning"})}e.$refs.ruleForm.validate(function(t){if(t){var i={equipmentType:e.ruleForm.equipmentType,communication:e.ruleForm.communication,billing:e.ruleForm.billing,description:e.ruleForm.description,price:Number(e.ruleForm.price),coins:Number(e.ruleForm.coins),serviceTime:Number(e.ruleForm.serviceTime)};2===e.ruleForm.communication&&(2!==e.ruleForm.billing?i.coins=Number(e.ruleForm.serviceTime):(i.electric=Number(e.ruleForm.electric),i.serviceTime=Math.round(100*i.electric),i.coins=Number(i.serviceTime))),1===e.ruleForm.communication&&""===e.ruleForm.serviceTime&&delete i.serviceTime,e.loading_submit=!0,"edit"===e.actionType?(i.agentGroupServiceId=e.actionRow.agentGroupServiceId,Object(n.c)(i).then(function(t){0===t.result&&0===t.data&&(Object(r.Message)({message:"编辑服务套餐成功！",type:"success"}),e.queryList(1),e.onClose())}).finally(function(){e.loading_submit=!1})):Object(n.b)(i).then(function(t){0===t.result&&0===t.data&&(Object(r.Message)({message:"添加服务套餐成功！",type:"success"}),e.queryList(1),e.onClose())}).finally(function(){e.loading_submit=!1})}})},changeCommunication:function(e){this.ruleForm.billing=1}}},s=(i("0Bl4"),i("KHd+")),u=Object(s.a)(c,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:e.getTitle,visible:e.visible,width:"500px"},on:{close:e.onClose,opened:e.onOpen}},[i("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-position":"left","label-width":"100px"}},[i("el-form-item",{attrs:{label:"设备类型",prop:"equipmentType"}},[i("el-select",{staticClass:"sel-item",attrs:{disabled:!0},model:{value:e.ruleForm.equipmentType,callback:function(t){e.$set(e.ruleForm,"equipmentType",t)},expression:"ruleForm.equipmentType"}},[i("el-option",{attrs:{label:"充电桩",value:"CDZ"}})],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"通信方式",prop:"communication"}},[i("el-select",{staticClass:"sel-item",on:{change:e.changeCommunication},model:{value:e.ruleForm.communication,callback:function(t){e.$set(e.ruleForm,"communication",t)},expression:"ruleForm.communication"}},[i("el-option",{attrs:{value:1,label:"脉冲"}}),e._v(" "),i("el-option",{attrs:{value:2,label:"串口"}})],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"计费方式",prop:"billing"}},[i("el-select",{staticClass:"sel-item",attrs:{disabled:2!==e.ruleForm.communication},model:{value:e.ruleForm.billing,callback:function(t){e.$set(e.ruleForm,"billing",t)},expression:"ruleForm.billing"}},e._l(e.arrBilling,function(e,t){return i("el-option",{key:t,attrs:{value:e.value,label:e.label}})}))],1),e._v(" "),i("el-form-item",{attrs:{label:"套餐名称",prop:"description"}},[i("el-input",{model:{value:e.ruleForm.description,callback:function(t){e.$set(e.ruleForm,"description",t)},expression:"ruleForm.description"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"价格(元)",prop:"price"}},[i("el-input",{model:{value:e.ruleForm.price,callback:function(t){e.$set(e.ruleForm,"price",t)},expression:"ruleForm.price"}})],1),e._v(" "),2==e.ruleForm.billing?i("el-form-item",{key:"2",attrs:{label:"电量(度)",prop:"electric"}},[i("el-input",{key:"input2",model:{value:e.ruleForm.electric,callback:function(t){e.$set(e.ruleForm,"electric",t)},expression:"ruleForm.electric"}})],1):e._e(),e._v(" "),2!==e.ruleForm.billing?i("el-form-item",{key:"1",attrs:{label:"时长(分钟)",prop:"serviceTime"}},[i("el-input",{key:"input1",model:{value:e.ruleForm.serviceTime,callback:function(t){e.$set(e.ruleForm,"serviceTime",t)},expression:"ruleForm.serviceTime"}})],1):e._e(),e._v(" "),2!==e.ruleForm.communication?i("el-form-item",{key:"coins",attrs:{label:"模拟投币数",prop:"coins"}},[i("el-input",{key:"input3",model:{value:e.ruleForm.coins,callback:function(t){e.$set(e.ruleForm,"coins",t)},expression:"ruleForm.coins"}})],1):e._e()],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.onClose}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{loading:e.loading_submit,type:"primary"},on:{click:e.onSubmit}},[e._v("保 存")])],1)],1)},[],!1,null,"7c1a7467",null);u.options.__file="serviceSellDialog.vue";t.default=u.exports},o7LA:function(e,t,i){},szQx:function(e,t,i){"use strict";i.r(t);var r=i("bSnj"),n=i("7Qib"),o=i("XJYT"),l={XYJ:"洗衣机",CDZ:"充电桩",AMY:"按摩椅",ZLJ:"足疗机",AMD:"按摩垫"},a=["无","脉冲","串口"],c=["无","按时长计费","按电量计费"],s={components:{editDialog:i("iR9m").default},data:function(){return{listLoading:!0,list:[],colums:[{key:"equipmentType",label:"设备类型",render:function(e){return l[e]}},{key:"communication",label:"通信方式",render:function(e){return a[e]}},{key:"billing",label:"计费方式",render:function(e){return c[e]}},{key:"description",label:"套餐名称"},{key:"price",label:"价格",render:function(e){return e+"元"}},{key:"val",label:"时长/电量"},{key:"resultCoins",label:"模拟投币数",render:function(e){return e?e+"币":"-"}},{key:"updated",label:"最新编辑时间",render:function(e){return Object(n.i)(e)}}],pageInfo:{total:0,pageSize:10,currPage:1},actionType:"",actionRow:null,vis_edit:!1}},created:function(){this.queryList()},methods:{handleDelete:function(e){var t=this;t.$confirm("确定要删除该服务套餐吗？","删除服务套餐",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1}).then(function(){t.listLoading=!0,Object(r.c)({agentGroupServiceId:e.agentGroupServiceId,deleted:1}).then(function(e){0===e.result&&(Object(o.Message)({message:"删除成功！",type:"success"}),t.queryList())}).finally(function(){t.listLoading=!1})}).catch(function(){})},handleEdit:function(e,t){this.actionType=e,this.actionRow=t,this.vis_edit=!0},handleClose:function(){this.vis_edit=!1},queryList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.listLoading=!0,this.pageInfo.currPage=t;var i={pageSize:this.pageInfo.pageSize,pageIndex:t};Object(r.a)(i).then(function(t){t.data?(e.list=t.data.items||[],e.pageInfo.total=t.data.total||0,e.list.forEach(function(e){2===e.billing?e.val=e.electric+"度":e.val=e.serviceTime?e.serviceTime+"分钟":"-",2===e.communication?e.resultCoins=0:e.resultCoins=e.coins})):e.pageInfo.total=0}).finally(function(){e.listLoading=!1})},handleSizeChange:function(e){this.pageInfo.pageSize=e,this.pageInfo.total=0,this.queryList(1)},handleCurrentChange:function(e){this.queryList(e)},filterQueryList:function(){this.pageInfo.total=0,this.queryList(this.pageInfo.currPage)}}},u=(i("d2aE"),i("KHd+")),m=Object(u.a)(s,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"content-area"},[i("el-button",{staticClass:"creat-btn",attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(){return e.handleEdit("add")}}},[e._v("添加服务套餐")]),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{data:e.list,height:550,border:"","highlight-current-row":""}},[e._l(e.colums,function(t,r){return i("el-table-column",{key:r,attrs:{prop:t.key,label:t.label,width:t.width,sortable:t.sortable,align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[e._v(e._s(t.render?t.render(i.row[t.key]):i.row[t.key]))]}}])})}),e._v(" "),i("el-table-column",{attrs:{width:"150px",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini"},on:{click:function(){return e.handleEdit("edit",t.row)}}},[e._v("编辑")]),e._v(" "),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(){return e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],2),e._v(" "),i("el-pagination",{attrs:{"page-sizes":[10,20,30,40],"page-size":e.pageInfo.pageSize,total:e.pageInfo.total,"current-page":e.pageInfo.currPage,background:"",layout:"total, prev, pager, next, sizes, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),i("edit-dialog",{attrs:{"query-list":e.queryList,visible:e.vis_edit,"handle-close":e.handleClose,"action-row":e.actionRow,"action-type":e.actionType}})],1)},[],!1,null,"274cfa82",null);m.options.__file="serviceSell.vue";t.default=m.exports},xXYc:function(e,t,i){}}]);