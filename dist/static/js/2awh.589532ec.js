(window.webpackJsonp=window.webpackJsonp||[]).push([["2awh"],{"2awh":function(e,a,t){"use strict";t.r(a);var s=t("14Xm"),l=t.n(s),r=t("D3Ub"),n=t.n(r),i=t("qpgI"),u={name:"ParamC",components:{verfyCode:t("YKrQ").default},data:function(){return{params:{},list:[],index:"",dataInfo:{},modalData:{pulseWidth:"",pulseInterval:""},type:"1",flag:!1,saveData:{pulseWidth:"",pulseInterval:"",battery:""},verfyCodeVisible:!1,phoneNumber:"",name:""}},watch:{index:function(e){var a=this.list[e];"自定义"===a.pulsePatternName?(this.flag=!0,this.saveData.pulseWidth="",this.saveData.pulseInterval="",this.modalData={pulseWidth:"",pulseInterval:""}):(this.saveData.pulseWidth=a.pulseWidth,this.saveData.pulseInterval=a.pulseInterval,this.modalData.pulseWidth=a.pulseWidth,this.modalData.pulseInterval=a.pulseInterval,this.flag=!1)}},created:function(){this.params=this.$route.query,this.phoneNumber=this.$route.query.phoneNumber,this.name=this.$route.query.name,this.query()},methods:{saveTemp:function(){this.modalData.pulseWidth<10||this.modalData.pulseWidth>1e3?this.$message({message:"脉冲宽度为10~1000整数",type:"error"}):this.modalData.pulseInterval<10||this.modalData.pulseInterval>1e3?this.$message({message:'"脉冲间隔为10~1000整数',type:"error"}):(this.saveData.pulseWidth=this.modalData.pulseWidth,this.saveData.pulseInterval=this.modalData.pulseInterval)},query:function(){var e=this;return n()(l.a.mark(function a(){var t;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t={value:e.params.value,data:1,t:Date.now()},a.next=3,Object(i.d)(t);case 3:1===a.sent.result?setTimeout(function(){e.getEquipmentParamDef()},2500):e.$message({message:"参数读取失败,不能设置",type:"error"});case 5:case"end":return a.stop()}},a,e)}))()},getEquipmentParamDef:function(){var e=this;return n()(l.a.mark(function a(){var t,s,r,n;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t={typeValue:e.params.typeValue,value:e.params.value,t:Date.now()},s={equipmentId:e.params.value},a.next=4,Object(i.f)(s);case 4:return r=a.sent,a.next=7,Object(i.j)(t);case 7:1===(n=a.sent).result&&(e.dataInfo=n.para,e.$nextTick(function(){e.saveData.pulseWidth=e.dataInfo.pulseWidth1,e.saveData.pulseInterval=e.dataInfo.pulseInterval1,e.saveData.battery=e.dataInfo.battery})),0===r.result&&(e.list=(r.data||[]).concat([{pulsePatternName:"自定义"}]),e.list.forEach(function(a,t){a.pulsePatternName!==e.dataInfo.pulsePatternName||(e.index=t)}),e.index===e.list.length-1&&(e.modalData.pulseWidth=e.dataInfo.pulseWidth,e.modalData.pulseInterval=e.dataInfo.pulseInterval,setTimeout(function(){e.saveData.pulseWidth=e.dataInfo.pulseWidth1,e.saveData.pulseInterval=e.dataInfo.pulseInterval1,e.saveData.battery=e.dataInfo.battery},500))),e.$nextTick(function(){"自定义"===n.para.pulsePatternName&&(e.modalData.pulseWidth=e.dataInfo.pulseWidth1,e.modalData.pulseInterval=e.dataInfo.pulseInterval1)});case 11:case"end":return a.stop()}},a,e)}))()},saveNewEquipmentBefore:function(){this.index===this.list.length-1&&(this.saveData.pulseWidth=this.modalData.pulseWidth,this.saveData.pulseInterval=this.modalData.pulseInterval),this.saveData.pulseWidth&&this.saveData.pulseInterval?this.modalData.pulseWidth<10||this.modalData.pulseWidth>1e3?this.$message({message:"脉冲宽度为10~1000整数",type:"error"}):this.modalData.pulseInterval<10||this.modalData.pulseInterval>1e3?this.$message({message:'"脉冲间隔为10~1000整数',type:"error"}):this.verfyCodeVisible=!0:this.$message({message:"脉冲设置或脉冲间隔不能为空",type:"error"})},saveNewEquipment:function(){var e=this;return n()(l.a.mark(function a(){var t;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(e.index===e.list.length-1&&(e.saveData.pulseWidth=e.modalData.pulseWidth,e.saveData.pulseInterval=e.modalData.pulseInterval),e.saveData.pulseWidth&&e.saveData.pulseInterval){a.next=4;break}return e.$message({message:"脉冲设置或脉冲间隔不能为空",type:"error"}),a.abrupt("return");case 4:if(!(e.modalData.pulseWidth<10||e.modalData.pulseWidth>1e3)){a.next=7;break}return e.$message({message:"脉冲宽度为10~1000整数",type:"error"}),a.abrupt("return");case 7:if(!(e.modalData.pulseInterval<10||e.modalData.pulseInterval>1e3)){a.next=10;break}return e.$message({message:'"脉冲间隔为10~1000整数',type:"error"}),a.abrupt("return");case 10:return t={value:e.params.value,pulseWidth1:e.saveData.pulseWidth,pulseInterval1:e.saveData.pulseInterval,battery:e.saveData.battery,pulseWidth2:0,pulseInterval2:0,gift:0,drag:0,interfaceType:0,interfaceBaudRate:0,noteTypes:0},a.next=13,Object(i.p)(t);case 13:1===a.sent.result&&(e.verfyCodeVisible=!1,e.$message({message:"设置成功",type:"success"}));case 15:case"end":return a.stop()}},a,e)}))()},goBack:function(){window.history.go(-1)}}},p=t("KHd+"),o=Object(p.a)(u,function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticStyle:{margin:"40px"}},[t("div",{staticStyle:{"margin-bottom":"20px","font-size":"14px"}},[e._v(e._s(e.params.equipmentTypeName)+": "+e._s(e.params.value)),t("span",{staticStyle:{color:"#888","margin-left":"10px"}},[e._v("(脉冲宽度 / 间隔范围为10-1000)")])]),e._v(" "),t("el-form",[t("el-form-item",{attrs:{label:"脉冲设置"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.index,callback:function(a){e.index=a},expression:"index"}},e._l(e.list,function(e,a){return t("el-option",{key:e.value,attrs:{label:e.pulsePatternName,value:a}})}))],1),e._v(" "),t("p",{staticStyle:{"font-size":"14px",color:"#888","margin-top":"20px","margin-bottom":"20px"}},[e._v(" 脉冲设置： 脉冲宽度"+e._s(e.saveData.pulseWidth)+", 脉冲间隔 "+e._s(e.saveData.pulseInterval)+" ")]),e._v(" "),e.flag?t("div",[t("el-form-item",{attrs:{label:"脉冲宽度"}},[t("el-input",{staticClass:"input-300",attrs:{placeholder:"请输入10~1000之间整数",type:"number",maxlength:"4",clearable:""},model:{value:e.modalData.pulseWidth,callback:function(a){e.$set(e.modalData,"pulseWidth",a)},expression:"modalData.pulseWidth"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"脉冲间隔"}},[t("el-input",{staticClass:"input-300",attrs:{placeholder:"请输入10~1000之间整数",type:"number",maxlength:"4",clearable:""},model:{value:e.modalData.pulseInterval,callback:function(a){e.$set(e.modalData,"pulseInterval",a)},expression:"modalData.pulseInterval"}})],1)],1):e._e(),e._v(" "),t("el-form-item",{attrs:{label:"待机电平"}},[t("el-radio",{attrs:{label:"0"},model:{value:e.saveData.battery,callback:function(a){e.$set(e.saveData,"battery",a)},expression:"saveData.battery"}},[e._v("常开")]),e._v(" "),t("el-radio",{attrs:{label:"1"},model:{value:e.saveData.battery,callback:function(a){e.$set(e.saveData,"battery",a)},expression:"saveData.battery"}},[e._v("常闭")])],1)],1),e._v(" "),t("div",{staticStyle:{"text-align":"left","margin-top":"80px"}},[t("el-button",{on:{click:e.goBack}},[e._v("返回上一页")]),e._v(" "),t("el-button",{on:{click:e.query}},[e._v("重新加载页面")]),e._v(" "),t("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary"},on:{click:e.saveNewEquipmentBefore}},[e._v("保存设置")])],1),e._v(" "),t("verfyCode",{attrs:{"phone-number":e.phoneNumber,name:e.name},on:{"on-OK":e.saveNewEquipment},model:{value:e.verfyCodeVisible,callback:function(a){e.verfyCodeVisible=a},expression:"verfyCodeVisible"}})],1)},[],!1,null,null,null);o.options.__file="deviceParamsLife.vue";a.default=o.exports}}]);