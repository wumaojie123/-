(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7a08"],{"8Reg":function(e,t,a){"use strict";var i=a("rrGt");a.n(i).a},B5LO:function(e,t,a){"use strict";a.d(t,"e",function(){return n}),a.d(t,"b",function(){return r}),a.d(t,"c",function(){return s}),a.d(t,"d",function(){return o}),a.d(t,"a",function(){return l});var i=a("Yfch"),n=function(e,t,a){if(!t||t&&!Object(i.d)(t))return a(new Error("请输入正确的11位手机号码"));a()},r=function(e,t,a){if(t&&!/^[A-Za-z0-9]{6,16}$/.test(t))return a(new Error("请输入6-16位的数字或字母"));a()},s=function(e,t,a){if(!/^([1-9][\d]{0,7}|0)(\.[\d]{1,2})?$/.test(t)||t>1e4)return a(new Error("价格必须为大于0的正数,价格需小于10000,最多保留2位小数"));a()},o=function(e,t,a){if(!/^([1-9][0-9]*)$/.test(t)||t>1440)return a(new Error("服务时间必须为大于0的小于等于1440(24小时)正整数"));a()},l=function(e,t,a){if(!/^([1-9][0-9]*)$/.test(t)||0===t||t>1e4)return a(new Error("模拟投币数必须为大于0的整数"));a()}},PvNR:function(e,t,a){"use strict";a.r(t);var i=a("omC7"),n=a.n(i),r=a("cLjf"),s=a.n(r),o=a("hDQ3"),l=a.n(o),c=a("qpgI"),u=a("B5LO"),d={components:{verfyCode:a("YKrQ").default},data:function(){return{lyyDistributorId:"",list:[],colums:[{key:"description",label:"套餐名称"},{key:"price",label:"价格(元)"},{key:"serviceTime",label:"时长(分钟)"},{key:"coins",label:"模拟投币数"}],pageInfo:{total:0,pageSize:10,pageIndex:1},selectList:[],dialogFormVisible:!1,lyyEquipmentId:"",modalData:{description:"",price:"",coins:"",serviceTime:""},lyyDistributorList:[],baseInfoRules:{description:[{required:!0,message:"请输入套餐名称",trigger:"blur"}],serviceTime:[{required:!0,validator:u.d,trigger:"blur"}],coins:[{required:!0,validator:u.a,trigger:"blur"}],price:[{required:!0,validator:u.c,trigger:"blur"}]},type:"",communication:"",verfyCodeVisible:!1,phoneNumber:"",name:"",actionType:"",handleItemData:{},lyyEquipmentValue:""}},created:function(){this.lyyEquipmentId=this.$route.query.lyyEquipmentId,this.lyyEquipmentValue=this.$route.query.value,this.communication=this.$route.query.communication,this.phoneNumber=this.$route.query.phoneNumber,this.name=this.$route.query.name,2==this.communication&&(this.colums=[{key:"description",label:"套餐名称"},{key:"price",label:"价格(元)"},{key:"serviceTime",label:"时长(分钟)"}]),this.queryList()},methods:{queryList:function(){var e=this;return l()(s.a.mark(function t(){var a,i;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.list=[],a={lyyEquipmentId:e.lyyEquipmentId,pageSize:e.pageInfo.pageSize,pageIndex:e.pageInfo.pageIndex},t.next=4,Object(c.g)(a);case 4:0===(i=t.sent).result&&(e.listLoading=!1,i.data?(e.list=i.data.items||[],e.pageInfo.total=i.data.total||0):e.pageInfo.total=0);case 6:case"end":return t.stop()}},t,e)}))()},handleSelectionChange:function(e){this.actionType="add",this.verfyCodeVisible=!1,this.type="modify",this.modalData=JSON.parse(n()(e)),this.dialogFormVisible=!0},handleSaveModal:function(){this.type="add",this.actionType="add",this.dialogFormVisible=!0,this.modalData={description:"",price:"",coins:"",serviceTime:""}},handleSaveBefore:function(){var e,t=this;this.$refs.baseInfoRules.validate((e=l()(s.a.mark(function e(a){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a&&(t.verfyCodeVisible=!0);case 1:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))},handleCheck:function(){"add"===this.actionType?this.handleSave():(this.verfyCodeVisible=!1,this.delService())},handleSave:function(){var e,t=this;this.$refs.baseInfoRules.validate((e=l()(s.a.mark(function e(a){var i,n,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=23;break}if(i={serviceTime:t.modalData.serviceTime,lyyEquipmentId:t.lyyEquipmentId},1===t.communication&&(i.coins=t.modalData.coins),"add"!==t.type){e.next=13;break}return n=t.modalData,2===t.communication&&(n.coins=n.serviceTime),n.lyyEquipmentId=t.lyyEquipmentId,e.next=9,Object(c.n)(n);case 9:0===e.sent.result?(t.verfyCodeVisible=!1,t.$message({message:"添加服务套餐成功",type:"success"}),t.queryList(1),t.dialogFormVisible=!1):t.$message({message:"添加服务套餐失败",type:"error"}),e.next=21;break;case 13:if("modify"!==t.type){e.next=21;break}return r=t.modalData,2===t.communication&&(r.coins=r.serviceTime),r.lyyEquipmentId=t.lyyEquipmentId,e.next=19,Object(c.v)(r);case 19:0===e.sent.result&&(t.verfyCodeVisible=!1,t.$message({message:"更新服务套餐成功",type:"success"}),t.queryList(1),t.dialogFormVisible=!1);case 21:e.next=24;break;case 23:return e.abrupt("return",!1);case 24:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))},handleBatchSave:function(){var e=this;return l()(s.a.mark(function t(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==e.selectList.length){t.next=3;break}return e.$message({message:"请至少选择一个服务套餐",type:"error"}),t.abrupt("return");case 3:return a={communication:e.communication,equipmentType:e.deviceType,values:e.equipmentArr,lyyDistributorId:e.lyyDistributorId},t.next=6,Object(c.b)(a);case 6:0===t.sent.result&&e.$message({message:"请至少选择一个服务套餐",type:"error"});case 8:case"end":return t.stop()}},t,e)}))()},delServiceBefore:function(e){this.verfyCodeVisible=!0,this.actionType="del",this.handleItemData=JSON.pase(n()(e))},delService:function(){var e=this;this.$confirm("确定要删除该服务套餐吗？","删除服务套餐").then(l()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(c.e)({lyyGroupServiceId:e.handleItemData.lyyGroupServiceId});case 2:0===t.sent.result?(e.$message({message:"删除套餐成功",type:"success"}),e.queryList(1)):e.$message({message:"删除套餐失败",type:"error"});case 4:case"end":return t.stop()}},t,e)})))},handleSizeChange:function(e){this.pageInfo.pageSize=e,this.pageInfo.total=0,this.queryList(1)},handleCurrentChange:function(e){this.queryList(e)}}},p=(a("8Reg"),a("ZrdR")),m=Object(p.a)(d,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content-area"},[a("div",{staticClass:"table-title-info"},[a("span",[e._v("设备编号:"+e._s(e.lyyEquipmentValue))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSaveModal}},[e._v("添加套餐套餐")])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{data:e.list,border:"","highlight-current-row":"",height:"500"},on:{"selection-change":e.handleSelectionChange}},[e._l(e.colums,function(e,t){return a("el-table-column",{key:t,attrs:{prop:e.key,label:e.label,width:e.width,sortable:e.sortable,align:"center"}})}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.handleSelectionChange(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.delServiceBefore(t.row)}}},[e._v("删除")])]}}])})],2),e._v(" "),a("el-pagination",{attrs:{"page-sizes":[10,20,30,40],"page-size":e.pageInfo.pageSize,total:e.pageInfo.total,"current-page":e.pageInfo.currPage,background:"",layout:"total, prev, pager, next, sizes, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogFormVisible,title:"编辑套餐服务",width:"35%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"baseInfoRules",staticStyle:{"margin-top":"20px"},attrs:{model:e.modalData,rules:e.baseInfoRules,"label-width":"120px","label-position":"right"}},[a("el-form-item",{attrs:{label:"套餐名称",prop:"description"}},[a("el-input",{staticClass:"input-300",attrs:{placeholder:"请输入套餐名称",maxlength:"10"},model:{value:e.modalData.description,callback:function(t){e.$set(e.modalData,"description",t)},expression:"modalData.description"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"价格(元)",prop:"price"}},[a("el-input",{staticClass:"input-300",attrs:{placeholder:"请输入价格",type:"number",maxlength:"7",clearable:""},model:{value:e.modalData.price,callback:function(t){e.$set(e.modalData,"price",t)},expression:"modalData.price"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"时长(分钟)",prop:"serviceTime"}},[a("el-input",{staticClass:"input-300",attrs:{placeholder:"请输入时长",type:"tel",maxlength:"4",clearable:""},model:{value:e.modalData.serviceTime,callback:function(t){e.$set(e.modalData,"serviceTime",t)},expression:"modalData.serviceTime"}})],1),e._v(" "),"2"!=e.communication?[a("el-form-item",{attrs:{label:"模拟投币数",prop:"coins"}},[a("el-input",{staticClass:"input-300",attrs:{placeholder:"请输入模拟投币数",type:"number",maxlength:"4",clearable:""},model:{value:e.modalData.coins,callback:function(t){e.$set(e.modalData,"coins",t)},expression:"modalData.coins"}})],1)]:e._e()],2),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1,e.verfyCodeVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSaveBefore}},[e._v("保存并使用")])],1)],1),e._v(" "),a("verfyCode",{attrs:{"phone-number":e.phoneNumber,name:e.name},on:{"on-OK":e.handleCheck},model:{value:e.verfyCodeVisible,callback:function(t){e.verfyCodeVisible=t},expression:"verfyCodeVisible"}})],1)},[],!1,null,null,null);m.options.__file="deviceServiceEdit.vue";t.default=m.exports},rrGt:function(e,t,a){}}]);